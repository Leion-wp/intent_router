{
    "name": "leion-roots",
    "displayName": "Leion Roots",
    "description": "Human-centric visual orchestration runtime for VS Code",
    "publisher": "LeionCorp",
    "icon": "media/leion_roots_icon.png",
    "version": "0.0.2",
    "license": "MIT",
    "repository": {
        "type": "git",
        "url": "https://github.com/Leion-wp/intent_router.git"
    },
    "engines": {
        "vscode": "^1.75.0"
    },
    "main": "./out/extension.js",
    "activationEvents": [
        "onCommand:intentRouter.route",
        "onCommand:intentRouter.registerCapabilities",
        "onCommand:intentRouter.routeFromJson",
        "onCommand:intentRouter.createPipeline",
        "onCommand:intentRouter.runPipeline",
        "onCommand:intentRouter.dryRunPipeline",
        "onCommand:intentRouter.pipelines.new",
        "onCommand:intentRouter.pipelines.run",
        "onCommand:intentRouter.pipelines.dryRun",
        "onCommand:intentRouter.pipelines.openJson",
        "onCommand:intentRouter.pipelines.refresh",
        "onCommand:intentRouter.pipelines.openBuilder",
        "onCommand:intentRouter.generatePipelinePrompt",
        "onCommand:intentRouter.importPipelineFromClipboard",
        "onCommand:intentRouter.openCodex",
        "onCommand:intentRouter.generatePromptAndOpenCodex",
        "onCommand:intentRouter.importPipelineFromClipboardAndRun",
        "onView:intentRouterPipelines"
    ],
    "contributes": {
        "commands": [
            {
                "command": "intentRouter.route",
                "title": "Intent Router: Route Intent"
            },
            {
                "command": "intentRouter.routeFromJson",
                "title": "Intent Router: Route Intent (JSON)"
            },
            {
                "command": "intentRouter.createPipeline",
                "title": "Intent Router: Create Pipeline"
            },
            {
                "command": "intentRouter.runPipeline",
                "title": "Intent Router: Run Pipeline"
            },
            {
                "command": "intentRouter.dryRunPipeline",
                "title": "Intent Router: Dry Run Pipeline"
            },
            {
                "command": "intentRouter.pipelines.new",
                "title": "Intent Router: New Pipeline",
                "icon": "$(add)"
            },
            {
                "command": "intentRouter.pipelines.run",
                "title": "Intent Router: Run Selected Pipeline",
                "icon": "$(play)"
            },
            {
                "command": "intentRouter.pipelines.dryRun",
                "title": "Intent Router: Dry Run Selected Pipeline",
                "icon": "$(beaker)"
            },
            {
                "command": "intentRouter.pipelines.openJson",
                "title": "Intent Router: Open Pipeline JSON",
                "icon": "$(file-code)"
            },
            {
                "command": "intentRouter.pipelines.openBuilder",
                "title": "Intent Router: Open Pipeline Builder",
                "icon": "$(edit)"
            },
            {
                "command": "intentRouter.generatePipelinePrompt",
                "title": "Intent Router: Generate Pipeline Prompt",
                "icon": "$(sparkle)"
            },
            {
                "command": "intentRouter.importPipelineFromClipboard",
                "title": "Intent Router: Import Pipeline From Clipboard",
                "icon": "$(clippy)"
            },
            {
                "command": "intentRouter.openCodex",
                "title": "Intent Router: Open Codex",
                "icon": "$(comment-discussion)"
            },
            {
                "command": "intentRouter.generatePromptAndOpenCodex",
                "title": "Intent Router: Generate Prompt & Open Codex",
                "icon": "$(sparkle)"
            },
            {
                "command": "intentRouter.importPipelineFromClipboardAndRun",
                "title": "Intent Router: Import Pipeline From Clipboard & Run",
                "icon": "$(play-circle)"
            },
            {
                "command": "intentRouter.pipelines.refresh",
                "title": "Intent Router: Refresh Pipelines",
                "icon": "$(refresh)"
            }
        ],
        "viewsContainers": {
            "activitybar": [
                {
                    "id": "intentRouter",
                    "title": "Leion Roots",
                    "icon": "media/leion_roots_icon.png"
                }
            ]
        },
        "views": {
            "intentRouter": [
                {
                    "id": "intentRouterPipelines",
                    "name": "Intent Pipelines"
                }
            ]
        },
        "menus": {
            "view/title": [
                {
                    "command": "intentRouter.pipelines.new",
                    "when": "view == intentRouterPipelines",
                    "group": "navigation"
                },
                {
                    "command": "intentRouter.generatePromptAndOpenCodex",
                    "when": "view == intentRouterPipelines",
                    "group": "navigation"
                },
                {
                    "command": "intentRouter.importPipelineFromClipboardAndRun",
                    "when": "view == intentRouterPipelines",
                    "group": "navigation"
                },
                {
                    "command": "intentRouter.openCodex",
                    "when": "view == intentRouterPipelines",
                    "group": "navigation"
                },
                {
                    "command": "intentRouter.pipelines.run",
                    "when": "view == intentRouterPipelines",
                    "group": "navigation"
                },
                {
                    "command": "intentRouter.pipelines.dryRun",
                    "when": "view == intentRouterPipelines",
                    "group": "navigation"
                },
                {
                    "command": "intentRouter.pipelines.openJson",
                    "when": "view == intentRouterPipelines",
                    "group": "navigation"
                },
                {
                    "command": "intentRouter.pipelines.refresh",
                    "when": "view == intentRouterPipelines",
                    "group": "navigation"
                }
            ],
            "view/item/context": [
                {
                    "command": "intentRouter.pipelines.run",
                    "when": "view == intentRouterPipelines && viewItem == pipelineItem",
                    "group": "inline@1"
                },
                {
                    "command": "intentRouter.pipelines.dryRun",
                    "when": "view == intentRouterPipelines && viewItem == pipelineItem",
                    "group": "inline@2"
                },
                {
                    "command": "intentRouter.pipelines.openJson",
                    "when": "view == intentRouterPipelines && viewItem == pipelineItem",
                    "group": "inline@3"
                },
                {
                    "command": "intentRouter.pipelines.openBuilder",
                    "when": "view == intentRouterPipelines && viewItem == pipelineItem",
                    "group": "inline@4"
                }
            ]
        },
        "configuration": {
            "title": "Intent Router",
            "properties": {
                "intentRouter.mappings": {
                    "type": "array",
                    "default": [],
                    "description": "User-defined capability mappings that override registered providers.",
                    "items": {
                        "type": "object",
                        "required": [
                            "capability",
                            "command"
                        ],
                        "properties": {
                            "capability": {
                                "type": "string",
                                "description": "Normalized capability identifier (ex: git.push)."
                            },
                            "command": {
                                "type": "string",
                                "description": "VS Code command to execute for this capability."
                            },
                            "provider": {
                                "type": "string",
                                "description": "Optional provider name to scope this mapping."
                            },
                            "target": {
                                "type": "string",
                                "description": "Optional target name to scope this mapping."
                            },
                            "type": {
                                "type": "string",
                                "enum": [
                                    "vscode",
                                    "external"
                                ],
                                "description": "Provider type. External is reserved for future use."
                            }
                        }
                    }
                },
                "intentRouter.debug": {
                    "type": "boolean",
                    "default": false,
                    "description": "Enable verbose Intent Router logs in the console."
                },
                "intentRouter.logLevel": {
                    "type": "string",
                    "enum": [
                        "error",
                        "warn",
                        "info",
                        "debug"
                    ],
                    "default": "info",
                    "description": "Minimum log level for the Intent Router output channel."
                },
                "intentRouter.activeProfile": {
                    "type": "string",
                    "default": "",
                    "description": "Active profile name used for profile-specific mappings and provider settings."
                },
                "intentRouter.profiles": {
                    "type": "array",
                    "default": [],
                    "description": "Named profiles that can override mappings and provider enablement.",
                    "items": {
                        "type": "object",
                        "required": [
                            "name"
                        ],
                        "properties": {
                            "name": {
                                "type": "string",
                                "description": "Profile name."
                            },
                            "mappings": {
                                "type": "array",
                                "default": [],
                                "description": "Profile-specific mappings that override global mappings.",
                                "items": {
                                    "type": "object",
                                    "required": [
                                        "capability",
                                        "command"
                                    ],
                                    "properties": {
                                        "capability": {
                                            "type": "string",
                                            "description": "Normalized capability identifier (ex: git.push)."
                                        },
                                        "command": {
                                            "type": "string",
                                            "description": "VS Code command to execute for this capability."
                                        },
                                        "provider": {
                                            "type": "string",
                                            "description": "Optional provider name to scope this mapping."
                                        },
                                        "target": {
                                            "type": "string",
                                            "description": "Optional target name to scope this mapping."
                                        },
                                        "type": {
                                            "type": "string",
                                            "enum": [
                                                "vscode",
                                                "external"
                                            ],
                                            "description": "Provider type. External is reserved for future use."
                                        }
                                    }
                                }
                            },
                            "enabledProviders": {
                                "type": "array",
                                "default": [],
                                "items": {
                                    "type": "string"
                                },
                                "description": "If set, only these providers are allowed."
                            },
                            "disabledProviders": {
                                "type": "array",
                                "default": [],
                                "items": {
                                    "type": "string"
                                },
                                "description": "Providers to block."
                            }
                        }
                    }
                },
                "intentRouter.environment": {
                    "type": "object",
                    "default": {},
                    "description": "Workspace environment variables (and secrets) injected into terminal steps and available as ${var:NAME}.",
                    "additionalProperties": {
                        "type": "string"
                    }
                },
                "intentRouter.history.maxRuns": {
                    "type": "number",
                    "default": 50,
                    "minimum": 1,
                    "maximum": 500,
                    "description": "Maximum number of pipeline runs to keep in history.json."
                },
                "intentRouter.history.snapshotMode": {
                    "type": "string",
                    "enum": [
                        "full",
                        "minimal",
                        "none"
                    ],
                    "default": "full",
                    "description": "Snapshot storage mode for history: full=store full pipeline, minimal=store only meta.ui snapshot, none=disable snapshot/restore."
                },
                "intentRouter.demoProvider": {
                    "type": "string",
                    "enum": [
                        "",
                        "git"
                    ],
                    "default": "",
                    "description": "Enable a built-in demo provider (git) for quick testing."
                },
                "intentRouter.policy.ciStrict": {
                    "type": "boolean",
                    "default": false,
                    "description": "CI strict mode: block interactive (non-deterministic) steps like system.pause or vscode.runCommand."
                },
                "intentRouter.policy.interactiveBehavior": {
                    "type": "string",
                    "enum": [
                        "confirm",
                        "allow"
                    ],
                    "default": "confirm",
                    "description": "Behavior when an interactive step is encountered (when ciStrict=false). confirm=warn+confirm, allow=run without prompts."
                },
                "intentRouter.devMode": {
                    "type": "boolean",
                    "default": false,
                    "description": "Dev mode: show self-packaging preset pipeline (npm install/compile/vsce package/install vsix/reload)."
                },
                "leionRoots.adminMode": {
                    "type": "boolean",
                    "default": false,
                    "description": "Admin mode: enables Theme Studio draft editing for UI tokens."
                }
            }
        }
    },
    "scripts": {
        "vscode:prepublish": "npm run compile",
        "compile": "npm run build:webview && tsc -p ./",
        "watch": "tsc -watch -p ./",
        "test": "npm run compile && node ./out/test/runTest.js",
        "test:webview-state": "node ./scripts/run-webview-ui-state-tests.js",
        "test:stability": "node ./scripts/pr15-stability-gate.js",
        "build:webview": "node ./scripts/build-webview-with-retry.js",
        "build:webview:raw": "cd webview-ui && npm run build"
    },
    "devDependencies": {
        "@types/mocha": "^10.0.10",
        "@types/node": "16.x",
        "@types/vscode": "^1.75.0",
        "@vscode/codicons": "^0.0.44",
        "@vscode/test-electron": "^2.5.2",
        "glob": "^13.0.0",
        "mocha": "^11.7.5",
        "ts-node": "^10.9.2",
        "typescript": "^4.9.5"
    },
    "dependencies": {
        "zod": "^3.25.76"
    }
}
